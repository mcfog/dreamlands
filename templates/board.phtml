<?php
use Dreamlands\Entity\PostEntity;
use Dreamlands\Plate\DTemplate;

/**
 * @var DTemplate $this
 * @var PostEntity $board
 * @var PostEntity[] $posts
 */
?>
<?php $this->layout('layout/default', get_defined_vars()) ?>
<h5><?= $this->e($board->title) ?></h5>

<div class="intro"><?= $this->postContent($board) ?></div>
<?php $this->insert('partial/postbox', [
    'parent' => $board
]) ?>

<div class="post-list">
    <?php foreach ($posts as $post): ?>
    <div class="post">
        <?php $this->insert('partial/post', ['post' => $post]) ?>
    </div>
    <?php endforeach ?>
</div>

<script>
    [].forEach.call(document.querySelectorAll('.post .content'), function (el) {
        if (parseInt(el.clientHeight) < 100) return;
        el.classList.add('collapsed');
    });
</script>
